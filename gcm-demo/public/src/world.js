// Generated by CoffeeScript 1.7.1
(function() {
  var CharacterInfo, root;

  root = typeof exports !== "undefined" && exports !== null ? exports : this;

  CharacterInfo = (function() {
    function CharacterInfo(name, sprite, x, y) {
      this.name = name;
      this.sprite = sprite;
      this.x = x;
      this.y = y;
    }

    return CharacterInfo;

  })();

  root.World = (function() {
    function World(avatarName, avatarSprite) {
      this.avatarName = avatarName;
      this.avatarSprite = avatarSprite;
    }

    World.prototype.otherPcInfos = {};

    World.prototype.npcInfos = {};

    World.prototype.gameLayer = null;

    World.prototype.setGameLayer = function(layer) {
      return this.gameLayer = layer;
    };

    World.prototype.handlePacket = function(msgType, data) {
      var info, name, sprite, x, y, _ref, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6;
      switch (msgType) {
        case 'sPcMove':
          name = data.name;
          sprite = data.sprite;
          x = data.x;
          y = data.y;
          if (name in this.otherPcInfos) {
            info = this.otherPcInfos[name];
            _ref = [x, y], info.x = _ref[0], info.y = _ref[1];
            return (_ref1 = this.gameLayer) != null ? typeof _ref1.onMovePc === "function" ? _ref1.onMovePc(name, x, y) : void 0 : void 0;
          } else {
            info = new CharacterInfo(name, sprite, x, y);
            this.otherPcInfos[name] = info;
            return (_ref2 = this.gameLayer) != null ? typeof _ref2.onNewPc === "function" ? _ref2.onNewPc(name, sprite, x, y) : void 0 : void 0;
          }
          break;
        case 'sNpcMove':
          name = data.name;
          sprite = data.sprite;
          x = data.x;
          y = data.y;
          if (name in this.npcInfos) {
            info = this.npcInfos[name];
            _ref3 = [x, y], info.x = _ref3[0], info.y = _ref3[1];
            return (_ref4 = this.gameLayer) != null ? typeof _ref4.onMoveNpc === "function" ? _ref4.onMoveNpc(name, x, y) : void 0 : void 0;
          } else {
            info = new CharacterInfo(name, sprite, x, y);
            this.npcInfos[name] = info;
            return (_ref5 = this.gameLayer) != null ? typeof _ref5.onNewNpc === "function" ? _ref5.onNewNpc(name, sprite, x, y) : void 0 : void 0;
          }
          break;
        case 'sQuit':
          name = data;
          delete this.otherPcInfos[name];
          return (_ref6 = this.gameLayer) != null ? typeof _ref6.onQuitPc === "function" ? _ref6.onQuitPc(name) : void 0 : void 0;
      }
    };

    return World;

  })();

}).call(this);

//# sourceMappingURL=world.map
